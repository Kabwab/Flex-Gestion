<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="Paiement.css">
    <link rel="stylesheet" href="fontawesome-free-6.5.1-web/fontawesome-free-6.5.1-web/css/all.min.css">
      <link rel="icon" href="AB12.png" type="image/png">
</head>
<body>
   
<!-- MENU HAMBURGER -->
<div id="menu-hamburger" class="menu-hamburger">
  &#9776;
</div>

<nav class="sidebar" id="sidebar">
  <img src="AB12.png"alt="Logo">

  <a href="actu.html" class="canvas"><i class="fas fa-home"></i> Vue d'ensemble</a>

  <div class="grid-menu">
    <a href="premuin.html" class="menu-item">
      <i class="fas fa-calculator"></i>
      <span>Modèles</span>
    </a>

    <a href="avis.html"class="menu-item">
      <i class="fas fa-comment-dots"></i>
      <span>Votre avis</span>
    </a>

    <a href="propos.html" class="menu-item">
      <i class="fas fa-info-circle"></i>
      <span>A Propos</span>
    </a>
  </div>
</nav>



<style>
  /* --- Hamburger --- */
.menu-hamburger {
  display: none; /* caché par défaut sur grand écran */
  position: fixed;
  top: 15px;
  left: 15px;
  font-size: 30px;
  cursor: pointer;
  z-index: 1001; /* au-dessus du menu */
  color: #003366; /* couleur du hamburger */
}

/* --- Responsive --- */
@media (max-width: 768px) {
  .menu-hamburger {
    display: block; /* visible aux petits écrans */
  }

  .sidebar {
    transform: translateX(-100%); /* menu caché par défaut */
    transition: transform 0.3s ease;
  }

  .sidebar.active {
    transform: translateX(0); /* menu visible quand actif */
  }
}

@media (max-width: 600px) {
  .menu-hamburger {
    left: 10px;
    font-size: 28px;
  }
}

@media (max-width: 400px) {
  .menu-hamburger {
    left: 8px;
    font-size: 25px;
  }
}

</style>

<script>
  const menu = document.getElementById("menu-hamburger");
const sidebar = document.getElementById("sidebar");

menu.addEventListener('click', () => {
  sidebar.classList.toggle("active");
});

</script>

<section class="tent">
<!-- Modèle 1 : Paiement Mensuel -->
<div class="table-block">
  <h2>Gestion des Paiements (Modèle 1)</h2>
  <div class="buttons">
    <button class="btn" id="exportExcelPay1">Télécharger Excel</button>
    <button class="btn" id="exportPDFPay1">Télécharger PDF</button>
  </div>
  <table id="payTable1">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Matricule</th>
        <th>Salaire de Base</th>
        <th>Primes</th>
        <th>Retenues</th>
        <th>Salaire Net</th>
        <th>% Primes</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Jean</td><td>EMP001</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Marie</td><td>EMP002</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Paul</td><td>EMP003</td><td></td><td></td><td></td><td></td><td></td></tr>
    </tbody>
  </table>
</div>

<!-- Modèle 2 : Historique des paiements -->
<div class="table-block">
  <h2>Gestion des Paiements (Modèle 2)</h2>
  <div class="buttons">
    <button class="btn" id="exportExcelPay2">Télécharger Excel</button>
    <button class="btn" id="exportPDFPay2">Télécharger PDF</button>
  </div>
  <table id="payTable2">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Matricule</th>
        <th>Mois</th>
        <th>Montant Payé</th>
        <th>Retenue</th>
        <th>Total Payé</th>
        <th>Reste Dû</th>
        <th>% Payé</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Jean</td><td>EMP001</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Marie</td><td>EMP002</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Paul</td><td>EMP003</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    </tbody>
  </table>
</div>


<!-- Modèle 3 : Suivi des absences et retards -->
<div class="table-block">
  <h2>Gestion des Travailleurs (Modèle 3)</h2>
  <div class="buttons">
    <button class="btn" id="exportExcelPay3">Télécharger Excel</button>
    <button class="btn" id="exportPDFPay3">Télécharger PDF</button>
  </div>
  <table id="payTable3">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Matricule</th>
        <th>Jours Présents</th>
        <th>Jours Absents</th>
        <th>Retards</th>
        <th>% Présence</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Jean</td><td>EMP001</td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Marie</td><td>EMP002</td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Paul</td><td>EMP003</td><td></td><td></td><td></td><td></td></tr>
    </tbody>
  </table>
</div>

<!-- Modèle 4 : Évaluation des objectifs trimestriels -->
<div class="table-block">
  <h2>Gestion des Travailleurs (Modèle 4)</h2>
  <div class="buttons">
    <button class="btn" id="exportExcelPay4">Télécharger Excel</button>
    <button class="btn" id="exportPDFPay4">Télécharger PDF</button>
  </div>
  <table id="payTable4">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Matricule</th>
        <th>Objectif 1</th>
        <th>Objectif 2</th>
        <th>Objectif 3</th>
        <th>Total Réalisé</th>
        <th>% Atteint</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Jean</td><td>EMP001</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Marie</td><td>EMP002</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Paul</td><td>EMP003</td><td></td><td></td><td></td><td></td><td></td></tr>
    </tbody>
  </table>
</div>

<!-- Modèle 5 : Calcul des primes et bonus -->
<div class="table-block">
  <h2>Gestion des Travailleurs (Modèle 5)</h2>
  <div class="buttons">
    <button class="btn" id="exportExcelPay5">Télécharger Excel</button>
    <button class="btn" id="exportPDFPay5">Télécharger PDF</button>
  </div>
  <table id="payTable5">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Matricule</th>
        <th>Salaire Base</th>
        <th>Objectifs Atteints</th>
        <th>Prime %</th>
        <th>Bonus</th>
        <th>Total à Payer</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Jean</td><td>EMP001</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Marie</td><td>EMP002</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Paul</td><td>EMP003</td><td></td><td></td><td></td><td></td><td></td></tr>
    </tbody>
  </table>
</div>

<!-- Modèle 6 : Analyse de performance globale -->
<div class="table-block">
  <h2>Gestion des Travailleurs (Modèle 6)</h2>
  <div class="buttons">
    <button class="btn" id="exportExcelPay6">Télécharger Excel</button>
    <button class="btn" id="exportPDFPay6">Télécharger PDF</button>
  </div>
  <table id="payTable6">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Matricule</th>
        <th>Qualité</th>
        <th>Productivité</th>
        <th>Assiduité</th>
        <th>Score Total</th>
        <th>Classement</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Jean</td><td>EMP001</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Marie</td><td>EMP002</td><td></td><td></td><td></td><td></td><td></td></tr>
      <tr><td>Paul</td><td>EMP003</td><td></td><td></td><td></td><td></td><td></td></tr>
    </tbody>
  </table>
</div>


</section>


 <style>

.table-block {
  margin-bottom: 30px;
  overflow-x: auto; /* permet le scroll horizontal si écran petit */
}


    @media (max-width: 768px) {
  .tent {
    margin-left: 0; /* contenu prend toute la largeur */
    padding: 15px;
  }

  .sidebar.active ~ .tent {
    margin-left: 250px; /* si le menu est ouvert, décaler le contenu */
  }

  .table-block table {
    font-size: 14px; /* réduire la taille du texte sur mobile */
  }
}

@media (max-width: 600px) {
  .tent {
    padding: 10px;
  }

  .table-block table {
    font-size: 13px;
  }
}

@media (max-width: 400px) {
  .table-block table {
    font-size: 12px;
  }
}
   </style>







<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<script>
// ---------- Modèle 1 : Paiement Mensuel ----------
document.getElementById("exportExcelPay1").addEventListener("click", async function() {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Paiement Mensuel");

    sheet.addRow(["Nom","Matricule","Salaire de Base","Primes","Retenues","Salaire Net","% Primes"]);
    const header = sheet.getRow(1);
    header.font={bold:true,color:{argb:'FFFFFFFF'}};
    header.fill={type:'pattern',pattern:'solid',fgColor:{argb:'4472C4'}};
    header.alignment={horizontal:'center'};
    sheet.columns=[{width:20},{width:15},{width:18},{width:15},{width:15},{width:18},{width:15}];

    for(let i=2;i<=1000;i++){
        sheet.addRow([null,null,null,null,null,null,null]);
        // Salaire Net = Salaire de Base + Primes - Retenues
        sheet.getCell(`F${i}`).value = { formula: `C${i}+D${i}-E${i}` };
        // % Primes = D / C * 100
        sheet.getCell(`G${i}`).value = { formula: `D${i}/C${i}*100` };
    }

    const buffer = await workbook.xlsx.writeBuffer();
    saveAs(new Blob([buffer]), "Paiement_Mensuel.xlsx");
});

document.getElementById("exportPDFPay1").addEventListener("click", function() {
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const body=[];
    for(let i=1;i<=20;i++){ body.push(["","","","","","",""]); }
    doc.setFontSize(14);
    doc.text("Gestion des Paiements (Modèle 1)",60,15);
    doc.autoTable({
        startY:25,
        head:[["Nom","Matricule","Salaire de Base","Primes","Retenues","Salaire Net","% Primes"]],
        body:body,
        theme:"grid",
        headStyles:{fillColor:[52,152,219],textColor:255,halign:"center"},
        bodyStyles:{halign:"center"},
        alternateRowStyles:{fillColor:[240,240,240]}
    });
    doc.save("Paiement_Mensuel.pdf");
});

// ---------- Modèle 2 : Historique des paiements ----------
document.getElementById("exportExcelPay2").addEventListener("click", async function() {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Historique Paiements");

    sheet.addRow(["Nom","Matricule","Mois","Montant Payé","Retenue","Total Payé","Reste Dû","% Payé"]);
    const header = sheet.getRow(1);
    header.font={bold:true,color:{argb:'FFFFFFFF'}};
    header.fill={type:'pattern',pattern:'solid',fgColor:{argb:'4472C4'}};
    header.alignment={horizontal:'center'};
    sheet.columns=[{width:20},{width:15},{width:15},{width:18},{width:15},{width:18},{width:15},{width:15}];

    for(let i=2;i<=1000;i++){
        sheet.addRow([null,null,null,null,null,null,null,null]);
        // Total payé = Montant Payé - Retenue
        sheet.getCell(`F${i}`).value = { formula: `D${i}-E${i}` };
        // Reste Dû = Montant Payé - Total payé
        sheet.getCell(`G${i}`).value = { formula: `D${i}-F${i}` };
        // % payé = Total payé / Montant payé * 100
        sheet.getCell(`H${i}`).value = { formula: `F${i}/D${i}*100` };
    }

    const buffer = await workbook.xlsx.writeBuffer();
    saveAs(new Blob([buffer]), "Historique_Paiements.xlsx");
});

document.getElementById("exportPDFPay2").addEventListener("click", function() {
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const body=[];
    for(let i=1;i<=20;i++){ body.push(["","","","","","","",""]); }
    doc.setFontSize(14);
    doc.text("Gestion des Paiements (Modèle 2)",60,15);
    doc.autoTable({
        startY:25,
        head:[["Nom","Matricule","Mois","Montant Payé","Retenue","Total Payé","Reste Dû","% Payé"]],
        body:body,
        theme:"grid",
        headStyles:{fillColor:[52,152,219],textColor:255,halign:"center"},
        bodyStyles:{halign:"center"},
        alternateRowStyles:{fillColor:[240,240,240]}
    });
    doc.save("Historique_Paiements.pdf");
});
</script>



<script>
// ---------- Modèle 3 : Suivi des absences ----------
document.getElementById("exportExcelPay3").addEventListener("click", async function() {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Absences et Retards");

    sheet.addRow(["Nom","Matricule","Jours Présents","Jours Absents","Retards","% Présence"]);
    const header = sheet.getRow(1);
    header.font={bold:true,color:{argb:'FFFFFFFF'}};
    header.fill={type:'pattern',pattern:'solid',fgColor:{argb:'4472C4'}};
    header.alignment={horizontal:'center'};
    sheet.columns=[{width:20},{width:15},{width:15},{width:15},{width:15},{width:15}];

    for(let i=2;i<=1000;i++){
        sheet.addRow([null,null,null,null,null,null]);
        // % Présence = Jours Présents / (Jours Présents + Jours Absents) * 100
        sheet.getCell(`F${i}`).value = { formula: `C${i}/(C${i}+D${i})*100` };
    }

    const buffer = await workbook.xlsx.writeBuffer();
    saveAs(new Blob([buffer]), "Absences_Retards.xlsx");
});

document.getElementById("exportPDFPay3").addEventListener("click", function() {
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const body=[];
    for(let i=1;i<=20;i++){ body.push(["","","","","",""]); }
    doc.setFontSize(14);
    doc.text("Gestion des Travailleurs (Modèle 3)",60,15);
    doc.autoTable({
        startY:25,
        head:[["Nom","Matricule","Jours Présents","Jours Absents","Retards","% Présence"]],
        body:body,
        theme:"grid",
        headStyles:{fillColor:[52,152,219],textColor:255,halign:"center"},
        bodyStyles:{halign:"center"},
        alternateRowStyles:{fillColor:[240,240,240]}
    });
    doc.save("Absences_Retards.pdf");
});

// ---------- Modèle 4 : Évaluation trimestrielle ----------
document.getElementById("exportExcelPay4").addEventListener("click", async function() {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Objectifs Trimestriels");

    sheet.addRow(["Nom","Matricule","Objectif 1","Objectif 2","Objectif 3","Total Réalisé","% Atteint"]);
    const header = sheet.getRow(1);
    header.font={bold:true,color:{argb:'FFFFFFFF'}};
    header.fill={type:'pattern',pattern:'solid',fgColor:{argb:'4472C4'}};
    header.alignment={horizontal:'center'};
    sheet.columns=[{width:20},{width:15},{width:15},{width:15},{width:15},{width:18},{width:15}];

    for(let i=2;i<=1000;i++){
        sheet.addRow([null,null,null,null,null,null,null]);
        // Total Réalisé = Objectif 1 + Objectif 2 + Objectif 3
        sheet.getCell(`F${i}`).value = { formula: `C${i}+D${i}+E${i}` };
        // % Atteint = Total Réalisé / (Objectif 1 + Objectif 2 + Objectif 3) * 100
        sheet.getCell(`G${i}`).value = { formula: `F${i}/(C${i}+D${i}+E${i})*100` };
    }

    const buffer = await workbook.xlsx.writeBuffer();
    saveAs(new Blob([buffer]), "Objectifs_Trimestriels.xlsx");
});

document.getElementById("exportPDFPay4").addEventListener("click", function() {
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const body=[];
    for(let i=1;i<=20;i++){ body.push(["","","","","","",""]); }
    doc.setFontSize(14);
    doc.text("Gestion des Travailleurs (Modèle 4)",60,15);
    doc.autoTable({
        startY:25,
        head:[["Nom","Matricule","Objectif 1","Objectif 2","Objectif 3","Total Réalisé","% Atteint"]],
        body:body,
        theme:"grid",
        headStyles:{fillColor:[52,152,219],textColor:255,halign:"center"},
        bodyStyles:{halign:"center"},
        alternateRowStyles:{fillColor:[240,240,240]}
    });
    doc.save("Objectifs_Trimestriels.pdf");
});
</script>




<script>
// ---------- Modèle 5 : Primes et Bonus ----------
document.getElementById("exportExcelPay5").addEventListener("click", async function() {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Primes et Bonus");

    sheet.addRow(["Nom","Matricule","Salaire Base","Objectifs Atteints","Prime %","Bonus","Total à Payer"]);
    const header = sheet.getRow(1);
    header.font={bold:true,color:{argb:'FFFFFFFF'}};
    header.fill={type:'pattern',pattern:'solid',fgColor:{argb:'4472C4'}};
    header.alignment={horizontal:'center'};
    sheet.columns=[{width:20},{width:15},{width:15},{width:15},{width:15},{width:15},{width:18}];

    for(let i=2;i<=1000;i++){
        sheet.addRow([null,null,null,null,null,null,null]);
        sheet.getCell(`F${i}`).value={formula:`C${i}*E${i}/100`}; // Bonus = Salaire * Prime %
        sheet.getCell(`G${i}`).value={formula:`C${i}+F${i}`};      // Total à Payer = Salaire + Bonus
    }

    const buffer = await workbook.xlsx.writeBuffer();
    saveAs(new Blob([buffer]), "Primes_Bonus.xlsx");
});

document.getElementById("exportPDFPay5").addEventListener("click", function() {
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const body=[];
    for(let i=1;i<=20;i++){ body.push(["","","","","","",""]); }
    doc.setFontSize(14);
    doc.text("Gestion des Travailleurs (Modèle 5)",60,15);
    doc.autoTable({
        startY:25,
        head:[["Nom","Matricule","Salaire Base","Objectifs Atteints","Prime %","Bonus","Total à Payer"]],
        body:body,
        theme:"grid",
        headStyles:{fillColor:[52,152,219],textColor:255,halign:"center"},
        bodyStyles:{halign:"center"},
        alternateRowStyles:{fillColor:[240,240,240]}
    });
    doc.save("Primes_Bonus.pdf");
});

// ---------- Modèle 6 : Analyse de performance ----------
document.getElementById("exportExcelPay6").addEventListener("click", async function() {
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet("Performance Globale");

    sheet.addRow(["Nom","Matricule","Qualité","Productivité","Assiduité","Score Total","Classement"]);
    const header = sheet.getRow(1);
    header.font={bold:true,color:{argb:'FFFFFFFF'}};
    header.fill={type:'pattern',pattern:'solid',fgColor:{argb:'4472C4'}};
    header.alignment={horizontal:'center'};
    sheet.columns=[{width:20},{width:15},{width:15},{width:15},{width:15},{width:18},{width:15}];

    for(let i=2;i<=1000;i++){
        sheet.addRow([null,null,null,null,null,null,null]);
        sheet.getCell(`F${i}`).value={formula:`C${i}+D${i}+E${i}`}; // Score Total = Qualité + Productivité + Assiduité
        sheet.getCell(`G${i}`).value={formula:`IF(F${i}>=270,\"Excellent\",IF(F${i}>=200,\"Bien\",IF(F${i}>=150,\"Moyen\",\"Faible\")))`};
    }

    const buffer = await workbook.xlsx.writeBuffer();
    saveAs(new Blob([buffer]), "Performance_Globale.xlsx");
});

document.getElementById("exportPDFPay6").addEventListener("click", function() {
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const body=[];
    for(let i=1;i<=20;i++){ body.push(["","","","","","",""]); }
    doc.setFontSize(14);
    doc.text("Gestion des Travailleurs (Modèle 6)",60,15);
    doc.autoTable({
        startY:25,
        head:[["Nom","Matricule","Qualité","Productivité","Assiduité","Score Total","Classement"]],
        body:body,
        theme:"grid",
        headStyles:{fillColor:[52,152,219],textColor:255,halign:"center"},
        bodyStyles:{halign:"center"},
        alternateRowStyles:{fillColor:[240,240,240]}
    });
    doc.save("Performance_Globale.pdf");
});
</script>



</body>
</html>